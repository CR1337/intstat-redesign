#!/bin/bash

echo "Waiting for MySQL to be ready..."
sleep 7

# Wait until "MySQL init process done. Ready for start up." appears in logs
while ! docker compose logs 2>&1 | grep -q "MySQL init process done. Ready for start up."; do
    sleep 2
done

# Now wait until MySQL responds (final server)
while ! docker compose exec -T mysql mysqladmin ping -uroot --silent &> /dev/null; do
    sleep 2
done

echo "MySQL is ready."
